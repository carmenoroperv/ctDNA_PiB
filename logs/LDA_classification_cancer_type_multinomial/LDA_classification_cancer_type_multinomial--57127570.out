Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 5
Rules claiming more threads will be scaled down.
Select jobs to execute...

[Sat Nov 20 16:20:21 2021]
rule LDA_classification_cancer_type_multinomial:
    input: data/ATAC_predictions_train_20_predict_80/ATAC_pred_lasso_normalized_trimmed_formatted_standardized.rds, data/sample_types.txt
    output: Classification_output/Cancer_type_classification/LDA_multinomial.rds, Classification_output/ROC_plots/Cancer_type/ROC_LDA_multinomial.png
    jobid: 0
    threads: 5
    resources: mem_mb=300000, disk_mb=1000, tmpdir=/scratch/57127570, time=11:30:00

Rscript --vanilla /faststorage/project/DELFI1/Workspaces/CarmenAndAnika/.snakemake/scripts/tmpxwj54qs7.LDA_multinomial.R
Registered S3 methods overwritten by 'ggplot2':
  method         from 
  [.quosures     rlang
  c.quosures     rlang
  print.quosures rlang
Registered S3 method overwritten by 'rvest':
  method            from
  read_xml.response xml2
── Attaching packages ─────────────────────────────────────── tidyverse 1.2.1 ──
✔ ggplot2 3.1.1     ✔ purrr   0.3.4
✔ tibble  3.1.4     ✔ dplyr   1.0.7
✔ tidyr   1.1.3     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.4.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()

Attaching package: ‘MASS’

The following object is masked from ‘package:dplyr’:

    select

Type 'citation("pROC")' for a citation.

Attaching package: ‘pROC’

The following objects are masked from ‘package:stats’:

    cov, smooth, var

trying URL 'http://cran.us.r-project.org/src/contrib/pracma_2.3.3.tar.gz'
Content type 'application/x-gzip' length 400994 bytes (391 KB)
==================================================
downloaded 391 KB

* installing *source* package ‘pracma’ ...
** package ‘pracma’ successfully unpacked and MD5 sums checked
** using staged installation
** R
** data
*** moving datasets to lazyload DB
** demo
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (pracma)

The downloaded source packages are in
	‘/scratch/57127570/RtmpB0LTES/downloaded_packages’
Updating HTML index of packages in '.Library'
Making 'packages.html' ... done

Attaching package: ‘pracma’

The following object is masked from ‘package:purrr’:

    cross

trying URL 'http://cran.us.r-project.org/src/contrib/multiROC_1.1.1.tar.gz'
Content type 'application/x-gzip' length 12316 bytes (12 KB)
==================================================
downloaded 12 KB

* installing *source* package ‘multiROC’ ...
** package ‘multiROC’ successfully unpacked and MD5 sums checked
** using staged installation
** R
** data
*** moving datasets to lazyload DB
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (multiROC)

The downloaded source packages are in
	‘/scratch/57127570/RtmpB0LTES/downloaded_packages’
Updating HTML index of packages in '.Library'
Making 'packages.html' ... done
trying URL 'http://cran.us.r-project.org/src/contrib/dummies_1.5.6.tar.gz'
Content type 'application/x-gzip' length 8042 bytes
==================================================
downloaded 8042 bytes

* installing *source* package ‘dummies’ ...
** package ‘dummies’ successfully unpacked and MD5 sums checked
** using staged installation
** R
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (dummies)

The downloaded source packages are in
	‘/scratch/57127570/RtmpB0LTES/downloaded_packages’
Updating HTML index of packages in '.Library'
Making 'packages.html' ... done
dummies-1.5.6 provided by Decision Patterns

# A tibble: 9 × 2
  sample_type           n
  <fct>             <int>
1 Bile_Duct_Cancer     25
2 Breast_Cancer        54
3 Colorectal_Cancer    26
4 Duodenal_Cancer       1
5 Gastric_cancer       27
6 Healthy             194
7 Lung_Cancer          35
8 Ovarian_Cancer       28
9 Pancreatic_Cancer    34
There were 50 or more warnings (use warnings() to see the first 50)
        observed CV_rep Bile_Duct_Cancer Breast_Cancer Colorectal_Cancer
1 Gastric_cancer      1      0.003384102  0.1850301269      1.451718e-03
2 Gastric_cancer      1      0.015394751  0.0665637223      6.671473e-04
3 Gastric_cancer      1      0.139444209  0.0001658274      1.640797e-05
4 Gastric_cancer      1      0.002170925  0.0949998743      2.819503e-03
5 Ovarian_Cancer      1      0.003290011  0.1572142668      6.762268e-03
6 Ovarian_Cancer      1      0.082158235  0.1956418908      6.644891e-03
  Gastric_cancer      Healthy  Lung_Cancer Ovarian_Cancer Pancreatic_Cancer
1   9.247448e-03 0.7669407441 1.027519e-02   0.0173114329       0.006359240
2   1.738249e-02 0.8768009010 4.290088e-03   0.0154499669       0.003450935
3   7.704814e-06 0.0004908665 1.487781e-05   0.0004660069       0.859394100
4   3.669103e-02 0.8406253428 1.424688e-02   0.0066235341       0.001822910
5   3.998598e-03 0.7092454509 4.938955e-02   0.0574250182       0.012674833
6   4.186559e-03 0.4606326894 1.605873e-02   0.0934943963       0.141182605
[1] "AUC calculation with pROC package == One vs. one"
[1] "The AUC of the first CV repetition: 0.758654223499754"
[1] "The mean AUC of all the CV repetitions: 0.758981221866546"
There were 50 or more warnings (use warnings() to see the first 50)
New names:
* Specificity -> Specificity...1
* Specificity -> Specificity...2
* Specificity -> Specificity...3
* Specificity -> Specificity...4
* Specificity -> Specificity...5
* ...
New names:
* Sensitivity -> Sensitivity...1
* Sensitivity -> Sensitivity...2
* Sensitivity -> Sensitivity...3
* Sensitivity -> Sensitivity...4
* Sensitivity -> Sensitivity...5
* ...
# A tibble: 10 × 10
   lasso.Bile_Duct_Cancer lasso.Breast_Cancer lasso.Colorectal… lasso.Gastric_c…
                    <dbl>               <dbl>             <dbl>            <dbl>
 1                  0.846               0.809             0.680            0.737
 2                  0.851               0.814             0.721            0.737
 3                  0.835               0.807             0.663            0.683
 4                  0.862               0.802             0.707            0.719
 5                  0.860               0.805             0.701            0.729
 6                  0.860               0.800             0.727            0.725
 7                  0.845               0.810             0.713            0.697
 8                  0.839               0.797             0.717            0.733
 9                  0.876               0.801             0.656            0.747
10                  0.866               0.817             0.701            0.696
# … with 6 more variables: lasso.Healthy <dbl>, lasso.Lung_Cancer <dbl>,
#   lasso.Ovarian_Cancer <dbl>, lasso.Pancreatic_Cancer <dbl>,
#   lasso.macro <dbl>, lasso.micro <dbl>
# A tibble: 6 × 3
  Specificity Sensitivity Group           
        <dbl>       <dbl> <fct>           
1       1           0     Bile_Duct_Cancer
2       0.998       0.004 Bile_Duct_Cancer
3       0.996       0.024 Bile_Duct_Cancer
4       0.994       0.032 Bile_Duct_Cancer
5       0.993       0.044 Bile_Duct_Cancer
6       0.990       0.048 Bile_Duct_Cancer
null device 
          1 
[1] "Mean AUC over 10 repetitions of 10-fold CV: "
 lasso.Bile_Duct_Cancer     lasso.Breast_Cancer lasso.Colorectal_Cancer 
              0.8540704               0.8062230               0.6987406 
   lasso.Gastric_cancer           lasso.Healthy       lasso.Lung_Cancer 
              0.7203143               0.8112659               0.8198601 
   lasso.Ovarian_Cancer lasso.Pancreatic_Cancer             lasso.macro 
              0.7717993               0.7400045               0.7777664 
            lasso.micro 
              0.8408054 
 [1] 0.4680851 0.4657210 0.4633570 0.4633570 0.4728132 0.4704492 0.4657210
 [8] 0.4680851 0.4728132 0.4775414
 [1] 0.5319149 0.5342790 0.5366430 0.5366430 0.5271868 0.5295508 0.5342790
 [8] 0.5319149 0.5271868 0.5224586
[1] "Mean error rate over 10 repetitions of 10-fold CV: 0.468794326241135"
[1] "Mean accuracy over 10 repetitions of 10-fold CV: 0.531205673758865"
[Sat Nov 20 17:29:55 2021]
Finished job 0.
1 of 1 steps (100%) done
